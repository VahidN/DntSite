/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/quill@2.0.3/modules/uploader.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Delta from"quill-delta";import Emitter from"../core/emitter.js";import Module from"../core/module.js";class Uploader extends Module{constructor(e,t){super(e,t),e.root.addEventListener("drop",(t=>{t.preventDefault();let o=null;if(document.caretRangeFromPoint)o=document.caretRangeFromPoint(t.clientX,t.clientY);else if(document.caretPositionFromPoint){const e=document.caretPositionFromPoint(t.clientX,t.clientY);o=document.createRange(),o.setStart(e.offsetNode,e.offset),o.setEnd(e.offsetNode,e.offset)}const n=o&&e.selection.normalizeNative(o);if(n){const o=e.selection.normalizedToRange(n);t.dataTransfer?.files&&this.upload(o,t.dataTransfer.files)}}))}upload(e,t){const o=[];Array.from(t).forEach((e=>{e&&this.options.mimetypes?.includes(e.type)&&o.push(e)})),o.length>0&&this.options.handler.call(this,e,o)}}Uploader.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(e,t){if(!this.quill.scroll.query("image"))return;const o=t.map((e=>new Promise((t=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.readAsDataURL(e)}))));Promise.all(o).then((t=>{const o=t.reduce(((e,t)=>e.insert({image:t})),(new Delta).retain(e.index).delete(e.length));this.quill.updateContents(o,Emitter.sources.USER),this.quill.setSelection(e.index+t.length,Emitter.sources.SILENT)}))}};export default Uploader;
//# sourceMappingURL=/sm/9628ba30fde9f55adcf8183c41660074cf8204df9a5bcfe5fad1bb8ffd02af85.map