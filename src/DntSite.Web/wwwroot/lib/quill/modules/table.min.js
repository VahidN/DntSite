/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/quill@2.0.3/modules/table.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Delta from"quill-delta";import Quill from"../core/quill.js";import Module from"../core/module.js";import{TableCell,TableRow,TableBody,TableContainer,tableId}from"../formats/table.js";class Table extends Module{static register(){Quill.register(TableCell),Quill.register(TableRow),Quill.register(TableBody),Quill.register(TableContainer)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(TableContainer).forEach((e=>{e.balanceCells()}))}deleteColumn(){const[e,,l]=this.getTable();null!=l&&(e.deleteColumn(l.cellOffset()),this.quill.update(Quill.sources.USER))}deleteRow(){const[,e]=this.getTable();null!=e&&(e.remove(),this.quill.update(Quill.sources.USER))}deleteTable(){const[e]=this.getTable();if(null==e)return;const l=e.offset();e.remove(),this.quill.update(Quill.sources.USER),this.quill.setSelection(l,Quill.sources.SILENT)}getTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.quill.getSelection();if(null==e)return[null,null,null,-1];const[l,t]=this.quill.getLine(e.index);if(null==l||l.statics.blotName!==TableCell.blotName)return[null,null,null,-1];const i=l.parent;return[i.parent.parent,i,l,t]}insertColumn(e){const l=this.quill.getSelection();if(!l)return;const[t,i,s]=this.getTable(l);if(null==s)return;const n=s.cellOffset();t.insertColumn(n+e),this.quill.update(Quill.sources.USER);let u=i.rowOffset();0===e&&(u+=1),this.quill.setSelection(l.index+u,l.length,Quill.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const l=this.quill.getSelection();if(!l)return;const[t,i,s]=this.getTable(l);if(null==s)return;const n=i.rowOffset();t.insertRow(n+e),this.quill.update(Quill.sources.USER),e>0?this.quill.setSelection(l,Quill.sources.SILENT):this.quill.setSelection(l.index+i.children.length,l.length,Quill.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,l){const t=this.quill.getSelection();if(null==t)return;const i=new Array(e).fill(0).reduce((e=>{const t=new Array(l).fill("\n").join("");return e.insert(t,{table:tableId()})}),(new Delta).retain(t.index));this.quill.updateContents(i,Quill.sources.USER),this.quill.setSelection(t.index,Quill.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(Quill.events.SCROLL_OPTIMIZE,(e=>{e.some((e=>!!["TD","TR","TBODY","TABLE"].includes(e.target.tagName)&&(this.quill.once(Quill.events.TEXT_CHANGE,((e,l,t)=>{t===Quill.sources.USER&&this.balanceTables()})),!0)))}))}}export default Table;
//# sourceMappingURL=/sm/b4ac911968e26e8871e8ed15b0f617dd35a552d5f4a9700e399646dd117dbb00.map