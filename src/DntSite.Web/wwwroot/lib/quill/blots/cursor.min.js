/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/quill@2.0.3/blots/cursor.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{EmbedBlot,Scope}from"parchment";import TextBlot from"./text.js";class Cursor extends EmbedBlot{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\ufeff";static value(){}constructor(t,e,s){super(t,e),this.selection=s,this.textNode=document.createTextNode(Cursor.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){null!=this.parent&&this.parent.removeChild(this)}format(t,e){if(0!==this.savedLength)return void super.format(t,e);let s=this,o=0;for(;null!=s&&s.statics.scope!==Scope.BLOCK_BLOT;)o+=s.offset(s.parent),s=s.parent;null!=s&&(this.savedLength=Cursor.CONTENTS.length,s.optimize(),s.formatAt(o,Cursor.CONTENTS.length,t,e),this.savedLength=0)}index(t,e){return t===this.textNode?0:super.index(t,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||null==this.parent)return null;const t=this.selection.getNativeRange();for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof TextBlot?this.prev:null,s=e?e.length():0,o=this.next instanceof TextBlot?this.next:null,r=o?o.text:"",{textNode:i}=this,n=i.data.split(Cursor.CONTENTS).join("");let a;if(i.data=Cursor.CONTENTS,e)a=e,(n||o)&&(e.insertAt(e.length(),n+r),o&&o.remove());else if(o)a=o,o.insertAt(0,n);else{const t=document.createTextNode(n);a=this.scroll.create(t),this.parent.insertBefore(a,this)}if(this.remove(),t){const r=(t,r)=>e&&t===e.domNode?r:t===i?s+r-1:o&&t===o.domNode?s+n.length+r:null,d=r(t.start.node,t.start.offset),l=r(t.end.node,t.end.offset);if(null!==d&&null!==l)return{startNode:a.domNode,startOffset:d,endNode:a.domNode,endOffset:l}}return null}update(t,e){if(t.some((t=>"characterData"===t.type&&t.target===this.textNode))){const t=this.restore();t&&(e.range=t)}}optimize(t){super.optimize(t);let{parent:e}=this;for(;e;){if("A"===e.domNode.tagName){this.savedLength=Cursor.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}}export default Cursor;
//# sourceMappingURL=/sm/0456053d1199b279e67a02cda6fb9195df4ba54e72d6c05f4cb6dfcd9463e942.map