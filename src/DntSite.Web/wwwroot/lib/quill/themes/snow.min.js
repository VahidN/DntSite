/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/quill@2.0.3/themes/snow.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{merge}from"lodash-es";import Emitter from"../core/emitter.js";import BaseTheme,{BaseTooltip}from"./base.js";import LinkBlot from"../formats/link.js";import{Range}from"../core/selection.js";import icons from"../ui/icons.js";import Quill from"../core/quill.js";const TOOLBAR_CONFIG=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class SnowTooltip extends BaseTooltip{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",(e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()})),this.root.querySelector("a.ql-remove").addEventListener("click",(e=>{if(null!=this.linkRange){const e=this.linkRange;this.restoreFocus(),this.quill.formatText(e,"link",!1,Emitter.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()})),this.quill.on(Emitter.events.SELECTION_CHANGE,((e,t,i)=>{if(null!=e){if(0===e.length&&i===Emitter.sources.USER){const[t,i]=this.quill.scroll.descendant(LinkBlot,e.index);if(null!=t){this.linkRange=new Range(e.index-i,t.length());const l=LinkBlot.formats(t.domNode);this.preview.textContent=l,this.preview.setAttribute("href",l),this.show();const o=this.quill.getBounds(this.linkRange);return void(null!=o&&this.position(o))}}else delete this.linkRange;this.hide()}}))}show(){super.show(),this.root.removeAttribute("data-mode")}}class SnowTheme extends BaseTheme{constructor(e,t){null!=t.modules.toolbar&&null==t.modules.toolbar.container&&(t.modules.toolbar.container=TOOLBAR_CONFIG),super(e,t),this.quill.container.classList.add("ql-snow")}extendToolbar(e){null!=e.container&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),icons),this.buildPickers(e.container.querySelectorAll("select"),icons),this.tooltip=new SnowTooltip(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},((t,i)=>{e.handlers.link.call(e,!i.format.link)})))}}SnowTheme.DEFAULTS=merge({},BaseTheme.DEFAULTS,{modules:{toolbar:{handlers:{link(e){if(e){const e=this.quill.getSelection();if(null==e||0===e.length)return;let t=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(t)&&0!==t.indexOf("mailto:")&&(t=`mailto:${t}`);const{tooltip:i}=this.quill.theme;i.edit("link",t)}else this.quill.format("link",!1,Quill.sources.USER)}}}}});export default SnowTheme;
//# sourceMappingURL=/sm/25bf896259201b0f067045f2c6fc650610d81d1408c531fccd5ef3fe8c07e46c.map