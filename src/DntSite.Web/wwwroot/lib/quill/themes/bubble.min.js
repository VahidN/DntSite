/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/quill@2.0.3/themes/bubble.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{merge}from"lodash-es";import Emitter from"../core/emitter.js";import BaseTheme,{BaseTooltip}from"./base.js";import{Range}from"../core/selection.js";import icons from"../ui/icons.js";import Quill from"../core/quill.js";const TOOLBAR_CONFIG=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class BubbleTooltip extends BaseTooltip{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(t,e){super(t,e),this.quill.on(Emitter.events.EDITOR_CHANGE,((t,e,i,o)=>{if(t===Emitter.events.SELECTION_CHANGE)if(null!=e&&e.length>0&&o===Emitter.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const t=this.quill.getLines(e.index,e.length);if(1===t.length){const t=this.quill.getBounds(e);null!=t&&this.position(t)}else{const i=t[t.length-1],o=this.quill.getIndex(i),l=Math.min(i.length()-1,e.index+e.length-o),s=this.quill.getBounds(new Range(o,l));null!=s&&this.position(s)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()}))}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",(()=>{this.root.classList.remove("ql-editing")})),this.quill.on(Emitter.events.SCROLL_OPTIMIZE,(()=>{setTimeout((()=>{if(this.root.classList.contains("ql-hidden"))return;const t=this.quill.getSelection();if(null!=t){const e=this.quill.getBounds(t);null!=e&&this.position(e)}}),1)}))}cancel(){this.show()}position(t){const e=super.position(t),i=this.root.querySelector(".ql-tooltip-arrow");return i.style.marginLeft="",0!==e&&(i.style.marginLeft=-1*e-i.offsetWidth/2+"px"),e}}class BubbleTheme extends BaseTheme{constructor(t,e){null!=e.modules.toolbar&&null==e.modules.toolbar.container&&(e.modules.toolbar.container=TOOLBAR_CONFIG),super(t,e),this.quill.container.classList.add("ql-bubble")}extendToolbar(t){this.tooltip=new BubbleTooltip(this.quill,this.options.bounds),null!=t.container&&(this.tooltip.root.appendChild(t.container),this.buildButtons(t.container.querySelectorAll("button"),icons),this.buildPickers(t.container.querySelectorAll("select"),icons))}}BubbleTheme.DEFAULTS=merge({},BaseTheme.DEFAULTS,{modules:{toolbar:{handlers:{link(t){t?this.quill.theme.tooltip.edit():this.quill.format("link",!1,Quill.sources.USER)}}}}});export{BubbleTooltip,BubbleTheme as default};
//# sourceMappingURL=/sm/7d146f3e2ad8a69c7801b4e18d4fb1d6c3dd334ec877fec0f794d1c1b90303ed.map